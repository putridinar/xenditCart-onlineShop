import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

// 🔥 Config Firebase Project kamu
function _0x3360(_0x4ed49d,_0x4cc350){const _0x49ce28=_0x49ce();return _0x3360=function(_0x3360ed,_0x303b2f){_0x3360ed=_0x3360ed-0x8c;let _0x2d228b=_0x49ce28[_0x3360ed];return _0x2d228b;},_0x3360(_0x4ed49d,_0x4cc350);}function _0x49ce(){const _0x5d2ac8=['price','1394540ncCMGe','stringify','name','G-M2JGJH3NVQ','POST','747234240117','json','❌\x20Checkout\x20Error:\x20','tokoputridinar','cartCountDesktop','uid','Keranjang\x20kosong!','data','color','3IPcGaZ','warning','/items','Silakan\x20login\x20untuk\x20checkout!','tokoputridinar.firebasestorage.app','1:747234240117:web:a87af4f6724ab87ad23a3c','983788JsKCon','AIzaSyDN2dgu-Sdsc9K5fermxPFwDUiCzX71ce8','invoice_url','getElementById','904mxxxpq','2485618bPprPG','tokoputridinar.firebaseapp.com','location','size','21703RCdxTj','20845Igflvd','parse','115576aLnjeH','❌\x20Gagal\x20buat\x20invoice:\x20','forEach','cartCountMobile','522lICWHb','innerText','push','45PtgjHH','image','1880XnfiOm','quantity','getItem','reduce','danger','empty'];_0x49ce=function(){return _0x5d2ac8;};return _0x49ce();}const _0x7a572d=_0x3360;(function(_0x57c799,_0x2c60af){const _0x3094a5=_0x3360,_0x293b61=_0x57c799();while(!![]){try{const _0x48c47f=-parseInt(_0x3094a5(0x9c))/0x1+parseInt(_0x3094a5(0xa1))/0x2+-parseInt(_0x3094a5(0x96))/0x3*(parseInt(_0x3094a5(0xa0))/0x4)+parseInt(_0x3094a5(0xa6))/0x5*(parseInt(_0x3094a5(0xac))/0x6)+-parseInt(_0x3094a5(0xb8))/0x7+-parseInt(_0x3094a5(0xa8))/0x8*(parseInt(_0x3094a5(0xaf))/0x9)+parseInt(_0x3094a5(0xb1))/0xa*(parseInt(_0x3094a5(0xa5))/0xb);if(_0x48c47f===_0x2c60af)break;else _0x293b61['push'](_0x293b61['shift']());}catch(_0x55e5d6){_0x293b61['push'](_0x293b61['shift']());}}}(_0x49ce,0xb0047));const firebaseConfig={'apiKey':_0x7a572d(0x9d),'authDomain':_0x7a572d(0xa2),'projectId':_0x7a572d(0x90),'storageBucket':_0x7a572d(0x9a),'messagingSenderId':_0x7a572d(0x8d),'appId':_0x7a572d(0x9b),'measurementId':_0x7a572d(0xbb)},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app);let currentUser=null;onAuthStateChanged(auth,_0x173dc5=>{currentUser=_0x173dc5;});function renderCart(){const _0x4d7e10=_0x7a572d,_0x519ff6=JSON[_0x4d7e10(0xa7)](localStorage[_0x4d7e10(0xb3)]('cart'))||[],_0x496b95=document[_0x4d7e10(0x9f)](_0x4d7e10(0xab)),_0x27903f=document[_0x4d7e10(0x9f)](_0x4d7e10(0x91));let _0x5e7a88=_0x519ff6[_0x4d7e10(0xb4)]((_0x5dfa4c,_0x1134c3)=>_0x5dfa4c+_0x1134c3[_0x4d7e10(0xb2)],0x0);if(_0x496b95)_0x496b95[_0x4d7e10(0xad)]=_0x5e7a88;if(_0x27903f)_0x27903f[_0x4d7e10(0xad)]=_0x5e7a88;}async function checkoutCart(){const _0x28348d=_0x7a572d;if(!currentUser){showToast(_0x28348d(0x99),'warning');return;}const _0x4e8570=collection(db,'carts/'+currentUser[_0x28348d(0x92)]+_0x28348d(0x98)),_0x5054c5=await getDocs(_0x4e8570);if(_0x5054c5[_0x28348d(0xb6)]){showToast(_0x28348d(0x93),_0x28348d(0x97));return;}let _0x354369=[],_0x1258f3=0x0;_0x5054c5[_0x28348d(0xaa)](_0x396bd9=>{const _0x465992=_0x28348d,_0x1354b8=_0x396bd9[_0x465992(0x94)]();_0x354369[_0x465992(0xae)]({'name':_0x1354b8[_0x465992(0xba)],'price':_0x1354b8[_0x465992(0xb7)],'quantity':_0x1354b8['quantity'],'color':_0x1354b8[_0x465992(0x95)],'size':_0x1354b8[_0x465992(0xa4)],'image':_0x1354b8[_0x465992(0xb0)]}),_0x1258f3+=_0x1354b8[_0x465992(0xb7)]*_0x1354b8[_0x465992(0xb2)];});try{const _0x3deab8=await fetch('https://xendit-app.putridinar.workers.dev',{'method':_0x28348d(0x8c),'headers':{'Content-Type':'application/json'},'body':JSON[_0x28348d(0xb9)]({'items':_0x354369,'total':_0x1258f3})}),_0x31db34=await _0x3deab8[_0x28348d(0x8e)]();_0x31db34['invoice_url']?window[_0x28348d(0xa3)]['href']=_0x31db34[_0x28348d(0x9e)]:showToast(_0x28348d(0xa9)+(_0x31db34['message']||'Unknown\x20error'),_0x28348d(0xb5));}catch(_0x371b19){console['error'](_0x371b19),showToast(_0x28348d(0x8f)+_0x371b19['message'],_0x28348d(0xb5));}}
window.checkoutCart = checkoutCart;